import{s as b,a as n,j as u,R as d,F as M}from"./index.b72de98d.js";import{T as V,C as J}from"./inputTypes.a1666a0c.js";import"./Radio.95366f1c.js";import"./theme.0c933903.js";import"./palette.15e4d008.js";import"./Tooltip.96777681.js";import"./Button.module.8f09dfc6.js";import"./useFocusRing.module.d931eb60.js";import"./context.module.586f6da9.js";import"./useButton.module.f0ff1b27.js";import"./OverlayArrow.module.39f052a4.js";import"./Info.9a0396d3.js";import"./Checkbox.6a136077.js";import"./sharedCheckboxStyles.46c399b6.js";var S={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.stateHasError=e.stateHasData=e.fetchIdle=e.fetchSuccess=e.fetchError=e.fetchLoading=e.FetchStateType=void 0;var t;(function(i){i.SUCCESS="success",i.ERROR="error",i.LOADING="loading",i.IDLE="idle"})(t=e.FetchStateType||(e.FetchStateType={}));const c=i=>({type:t.LOADING,...i&&"data"in i?{data:i.data}:{}});e.fetchLoading=c;const s=(i,m)=>({...m,type:t.ERROR,error:i});e.fetchError=s;const r=i=>({type:t.SUCCESS,data:i});e.fetchSuccess=r;const o=()=>({type:t.IDLE});e.fetchIdle=o;const a=i=>"data"in i;e.stateHasData=a;const l=i=>"error"in i;e.stateHasError=l})(S);const x=b(({children:e,...t})=>n("form",{...t,children:e}))`
  margin: 5px;
  > *:not(:first-child) {
    margin-top: 2rem;
  }

  h3 {
    border-bottom: 1px solid #ccc;
  }
`,C=b.div`
  > *:not(:first-child) {
    margin-top: 2rem;
  }
`;b(({state:e})=>S.stateHasError(e)?n("div",{children:e.error}):null)`
  font-weight: bold;
`;const B=b(e=>u("div",{className:e.className,children:["onCancel"in e?n(U,{onClick:e.onCancel,children:"Cancel"}):null,n(G,{})]}))`
  display: flex;
  flex-direction: row;
  justify-content: space-between;
  && {
    margin-top: 3rem;
  }
`,G=b(({...e})=>n("input",{type:"submit",value:"Submit",...e}))`
`,U=b(({...e})=>n("button",{...e}))`
`;var H={},O={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ifDefined=e.isPlainObject=e.isNumber=e.isDefined=void 0;const t=o=>o!==void 0;e.isDefined=t;const c=o=>typeof o=="number";e.isNumber=c;const s=o=>o instanceof Object&&o.__proto__.constructor.name==="Object";e.isPlainObject=s;const r=(o,a)=>(0,e.isDefined)(o)?o:a;e.ifDefined=r})(O);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.merge=e.getCommonProperties=void 0;const t=O,c=(r,o)=>Object.keys(r).filter(a=>Object.keys(o).includes(a));e.getCommonProperties=c;const s=(...[r,...o])=>{const a=o.length>0?(0,e.merge)(...o):null;return a?{...r,...a,...(0,e.getCommonProperties)(r,a).reduce((l,i)=>({...l,...(0,t.isPlainObject)(r[i])&&(0,t.isPlainObject)(a[i])?{[i]:(0,e.merge)(r[i],a[i])}:Array.isArray(r[i])&&Array.isArray(a[i])?{[i]:[...r[i],...a[i]]}:{}}),{})}:r};e.merge=s})(H);const w=()=>window.crypto.getRandomValues(new Uint32Array(1))[0].toString(16),y=d.createContext(()=>{throw new Error("form helpers not provided")}),g=()=>d.useContext(y)(),F=e=>({field:s=>r=>{e(o=>({...o,[s]:r}))},fields:e,merge:s=>e(r=>H.merge(r,s))}),$=(e,t,c)=>{const[s,r]=d.useState("data"in e&&e.data?e.data:t||{}),o=d.useRef(s);o.current=s;const a=d.useCallback(()=>{c==null||c(o.current)},[c]),l={namespace:"form",submit:a,data:s,state:e,setInput:F(r)};return l.rootHelpers=l,l},z=e=>{const t=g(),c=s=>t.setInput.fields(r=>({...r,[e]:s instanceof Function?s(r[e]||{}):s}));return{namespace:t.namespace+"."+e,submit:t.submit,data:t.data[e]||{},rootHelpers:t.rootHelpers,state:t.state,setInput:F(c)}},N=d.createContext(()=>{throw new Error("form list helpers not provided")}),R=()=>d.useContext(N)(),q=({name:e})=>{const t=g(),c=d.useCallback(a=>t.setInput.fields(l=>({...l,[e]:a instanceof Function?a(l[e]||[]):a})),[e,t.setInput]),s=a=>({data:a,rootHelpers:t.rootHelpers,state:t.state,submit:t.submit,namespace:t.namespace+"."+a.id,setInput:F(l=>c(i=>i.map(m=>m.id===a.id?l instanceof Function?l(m):l:m)))}),r=d.useMemo(()=>t.data[e]||[],[e,t.data]),o=d.useMemo(()=>r.every(a=>!!a.id),[r]);return d.useEffect(()=>{o||t.setInput.fields(a=>({...a,[e]:r.map(l=>l.id===void 0?{...l,id:w()}:l)}))},[r,o,e,t.setInput]),{addRecord:a=>t.setInput.fields(l=>({...l,[e]:[...l[e]||[],{id:w(),...a}]})),removeRecord:a=>t.setInput.fields(l=>({...l,[e]:(l[e]||[]).filter(i=>i.id!==a)})),data:o?r:[],rootHelpers:t.rootHelpers,setData:c,makeRecordHelpers:s}},K=(e,t,c)=>{const{disabled:s,emptyDisabledValue:r}=e,o=d.useRef(),a=d.useRef(c);a.current=c,d.useEffect(()=>{r!==!1&&s&&t&&(o.current=t,a.current(void 0)),r!==!1&&!s&&t===void 0&&t!==o.current&&a.current(o.current)},[s,r,t])},h=e=>{const{data:t,namespace:c,setInput:s}=g(),r=a=>{var l;(l=e.onChangeValue)==null||l.call(e,a),s.field(e.name)(a)},o=t[e.name];return K(e,o,r),n(V,{...e,name:c+"."+e.name,value:o||"",onChangeValue:r})},p=({children:e,state:t,onSubmit:c,defaultData:s,...r})=>{const o=$(t,s,c);return n(y.Provider,{value:()=>o,children:n(x,{...r,onSubmit:a=>{a.preventDefault(),o.submit()},children:e})})},I=e=>{const{state:t}=g();return n(B,{...e,state:t})},P=e=>{const{data:t}=g();return e.children(t[e.name])},v=e=>{const{data:t}=g();return e.children(t)},Q=e=>{const t=z(e.name);return n(y.Provider,{value:()=>t,children:e.children})},j=({children:e,...t})=>{const c=q(t);return n(N.Provider,{value:()=>c,children:e})},k=d.createContext(()=>{throw new Error("context not provided")}),L=e=>{const t=R(),[c,s]=d.useState(!1),r=d.useRef(),o=i=>m=>{if(!r.current)return;m.preventDefault();const D=t.data.findIndex(f=>f.id===r.current),E=t.data.findIndex(f=>f.id===i.id);if(D!==E){const f=[...t.data];f.splice(E,0,f.splice(D,1)[0]),t.setData(f)}},a=i=>{i.preventDefault(),s(!1)},l=i=>m=>{if(!c){m.preventDefault();return}m.dataTransfer.effectAllowed="move",r.current=i.id};return n(C,{children:t.data.map(i=>n(k.Provider,{value:s,children:n(y.Provider,{value:()=>t.makeRecordHelpers(i),children:n(C,{draggable:c,onDrop:a,onDragOver:o(i),onDragStart:l(i),style:{userSelect:"text"},children:e.children})})},i.id))})},W=e=>{const t=d.useContext(k);return n("div",{tabIndex:-1,...e,onMouseDown:()=>t(!0),style:{cursor:"move",backgroundImage:"radial-gradient(circle at 1px 1px, #aaa 1px, transparent 0), radial-gradient(circle at 4px 4px, #aaa 1px, transparent 0)",backgroundSize:"5px 6px",height:"11px",width:"11px",...e.style}})},T=e=>{const t=g(),c=R();return n("button",{...e,onClick:s=>{var r;c.removeRecord(t.data.id),(r=e.onClick)==null||r.call(e,s)},type:"button"})},_=e=>{const t=R();return n("button",{...e,onClick:c=>{var s;t.addRecord(),(s=e.onClick)==null||s.call(e,c)},type:"button"})},ue=()=>{const e={name:"Test McTesterson"},t=S.fetchSuccess(e),[c,s]=d.useState({});return u(p,{state:t,onSubmit:r=>s(r),children:[n(h,{name:"name",label:"Name"}),n(I,{}),n("pre",{children:JSON.stringify(c,null,2)})]})},A=b(C)`
  display: flex;
  flex-direction: row;

  > *:not(:first-child) {
    margin-top: 0;
    margin-left: 5px;
  }
`,me=()=>{const e={name:"Test McTesterson",interests:[{interest:"sleeping"}]},t=S.fetchSuccess(e),[c,s]=d.useState({}),[r,o]=d.useState(!1);return u(p,{state:t,onSubmit:a=>s(a),children:[n(h,{name:"name",label:"Name"}),n(J,{name:"sortable",label:"Sortable",onChangeValue:a=>o(!!a)}),u(j,{name:"interests",children:[n(L,{children:u(A,{children:[r?n(W,{style:{height:"auto"}}):null,n(h,{name:"interest",label:"Interest"}),n(T,{children:"remove interest"})]})}),n(_,{children:"add interest"})]}),n(I,{}),n("pre",{children:JSON.stringify(c,null,2)})]})},fe=()=>{const e={name:"Test McTesterson"},t=S.fetchSuccess(e);return u(p,{state:t,children:[n(h,{name:"name",label:"Name"}),n(I,{}),n(P,{name:"name",children:c=>n("pre",{children:JSON.stringify(c,null,2)})}),n(v,{children:c=>n("pre",{children:JSON.stringify(c,null,2)})})]})},he=()=>{const e={name:"Test McTesterson",interests:[{interest:"sleeping"}],address:{line1:"1 main st"}},t=S.fetchSuccess(e);return u(p,{state:t,children:[n(h,{name:"name",label:"Name"}),u("p",{children:["in a loop or namespace ",n("code",{children:"Forms.GetFormData"})," and ",n("code",{children:"Forms.GetFormValue"})," will return only values within the namespace"]}),n(v,{children:c=>u(M,{children:[u(Q,{name:"address",children:[n(h,{name:"line1",label:"line1"}),n(v,{children:s=>n("pre",{children:JSON.stringify(s,null,2)})}),n("p",{children:"if you need the parent context data in a subcomponent, you can wrap the entire section"}),n("pre",{children:JSON.stringify(c,null,2)})]}),u(j,{name:"interests",children:[u(L,{children:[u(A,{children:[n(h,{name:"interest",label:"Interest"}),n(T,{children:"remove interest"})]}),n(v,{children:s=>n("pre",{children:JSON.stringify(s,null,2)})})]}),n(_,{children:"add interest"})]}),n(I,{}),n(P,{name:"name",children:s=>n("pre",{children:JSON.stringify(s,null,2)})})]})})]})};typeof window<"u"&&window.document&&window.document.createElement&&document.documentElement.setAttribute("data-storyloaded","");export{ue as BasicControlledForm,fe as BasicDataReferences,he as DataReferencesInNamespaces,me as FormRepeatableElements};
