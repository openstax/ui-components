import{s as g,a as r,j as m,R as d,F as J}from"./index.c51a7bcd.js";import{T as B,C as G}from"./inputTypes.bf54f4b8.js";import"./Radio.a048e01f.js";import"./theme.d091109d.js";import"./palette.5e342580.js";import"./Tooltip.fa7c140d.js";import"./Button.module.acbe1597.js";import"./useFocusRing.module.20828055.js";import"./context.module.3c7ea2c8.js";import"./useButton.module.6f1ed581.js";import"./OverlayArrow.module.f4336192.js";import"./Info.7c7f5f20.js";import"./Checkbox.25d2e36e.js";import"./sharedCheckboxStyles.ffaa2b64.js";var u={};Object.defineProperty(u,"__esModule",{value:!0});var O=u.stateHasError=u.stateHasData=u.fetchIdle=v=u.fetchSuccess=u.fetchError=u.fetchLoading=u.FetchStateType=void 0,S;(function(e){e.SUCCESS="success",e.ERROR="error",e.LOADING="loading",e.IDLE="idle"})(S||(u.FetchStateType=S={}));const U=e=>({type:S.LOADING,...e&&"data"in e?{data:e.data}:{}});u.fetchLoading=U;const $=(e,t)=>({...t,type:S.ERROR,error:e});u.fetchError=$;const z=e=>({type:S.SUCCESS,data:e});var v=u.fetchSuccess=z;const q=()=>({type:S.IDLE});u.fetchIdle=q;const K=e=>"data"in e;u.stateHasData=K;const Q=e=>"error"in e;O=u.stateHasError=Q;const W=g(({children:e,...t})=>r("form",{...t,children:e}))`
  margin: 5px;
  > *:not(:first-child) {
    margin-top: 2rem;
  }

  h3 {
    border-bottom: 1px solid #ccc;
  }
`,R=g.div`
  > *:not(:first-child) {
    margin-top: 2rem;
  }
`;g(({state:e})=>O(e)?r("div",{children:e.error}):null)`
  font-weight: bold;
`;const X=g(e=>m("div",{className:e.className,children:["onCancel"in e?r(Z,{onClick:e.onCancel,children:"Cancel"}):null,r(Y,{})]}))`
  display: flex;
  flex-direction: row;
  justify-content: space-between;
  && {
    margin-top: 3rem;
  }
`,Y=g(({...e})=>r("input",{type:"submit",value:"Submit",...e}))`
`,Z=g(({...e})=>r("button",{...e}))`
`;var x={},P={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ifDefined=e.isPlainObject=e.isNumber=e.isNotNull=e.isDefined=void 0;const t=n=>n!==void 0;e.isDefined=t;const o=n=>n!==null;e.isNotNull=o;const a=n=>typeof n=="number";e.isNumber=a;const s=n=>n instanceof Object&&n.__proto__.constructor.name==="Object";e.isPlainObject=s;const i=(n,c)=>(0,e.isDefined)(n)?n:c;e.ifDefined=i})(P);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.merge=e.getCommonProperties=void 0;const t=P,o=(s,i)=>Object.keys(s).filter(n=>Object.keys(i).includes(n));e.getCommonProperties=o;const a=(...[s,...i])=>{const n=i.length>0?(0,e.merge)(...i):null;return n?{...s,...n,...(0,e.getCommonProperties)(s,n).reduce((c,l)=>({...c,...(0,t.isPlainObject)(s[l])&&(0,t.isPlainObject)(n[l])?{[l]:(0,e.merge)(s[l],n[l])}:Array.isArray(s[l])&&Array.isArray(n[l])?{[l]:[...s[l],...n[l]]}:{}}),{})}:s};e.merge=a})(x);const H=()=>window.crypto.getRandomValues(new Uint32Array(1))[0].toString(16),I=d.createContext(()=>{throw new Error("form helpers not provided")}),p=()=>d.useContext(I)(),D=e=>({field:a=>s=>{e(i=>({...i,[a]:s}))},fields:e,merge:a=>e(s=>x.merge(s,a))}),ee=(e,t,o)=>{const[a,s]=d.useState("data"in e&&e.data?e.data:t||{}),i=d.useRef(a);i.current=a;const n=d.useCallback(()=>{o==null||o(i.current)},[o]),c={namespace:"form",submit:n,data:a,state:e,setInput:D(s)};return c.rootHelpers=c,c},te=e=>{const t=p(),o=a=>t.setInput.fields(s=>({...s,[e]:a instanceof Function?a(s[e]||{}):a}));return{namespace:t.namespace+"."+e,submit:t.submit,data:t.data[e]||{},rootHelpers:t.rootHelpers,state:t.state,setInput:D(o)}},j=d.createContext(()=>{throw new Error("form list helpers not provided")}),N=()=>d.useContext(j)(),ne=({name:e})=>{const t=p(),o=d.useCallback(n=>t.setInput.fields(c=>({...c,[e]:n instanceof Function?n(c[e]||[]):n})),[e,t.setInput]),a=n=>({data:n,rootHelpers:t.rootHelpers,state:t.state,submit:t.submit,namespace:t.namespace+"."+n.id,setInput:D(c=>o(l=>l.map(f=>f.id===n.id?c instanceof Function?c(f):c:f)))}),s=d.useMemo(()=>t.data[e]||[],[e,t.data]),i=d.useMemo(()=>s.every(n=>!!n.id),[s]);return d.useEffect(()=>{i||t.setInput.fields(n=>({...n,[e]:s.map(c=>c.id===void 0?{...c,id:H()}:c)}))},[s,i,e,t.setInput]),{addRecord:n=>t.setInput.fields(c=>({...c,[e]:[...c[e]||[],{id:H(),...n}]})),removeRecord:n=>t.setInput.fields(c=>({...c,[e]:(c[e]||[]).filter(l=>l.id!==n)})),data:i?s:[],rootHelpers:t.rootHelpers,setData:o,makeRecordHelpers:a}},re=(e,t,o)=>{const{disabled:a,emptyDisabledValue:s}=e,i=d.useRef(),n=d.useRef(o);n.current=o,d.useEffect(()=>{s!==!1&&a&&t&&(i.current=t,n.current(void 0)),s!==!1&&!a&&t===void 0&&t!==i.current&&n.current(i.current)},[a,s,t])},b=e=>{const{data:t,namespace:o,setInput:a}=p(),s=n=>{var c;(c=e.onChangeValue)==null||c.call(e,n),a.field(e.name)(n)},i=t[e.name];return re(e,i,s),r(B,{...e,name:o+"."+e.name,value:(i!=null?i:"").toString(),onChangeValue:s})},C=({children:e,state:t,onSubmit:o,defaultData:a,...s})=>{const i=ee(t,a,o);return r(I.Provider,{value:()=>i,children:r(W,{...s,onSubmit:n=>{n.preventDefault(),i.submit()},children:e})})},F=e=>{const{state:t}=p();return r(X,{...e,state:t})},k=e=>{const{data:t}=p();return e.children(t[e.name])},y=e=>{const{data:t}=p();return e.children(t)},se=e=>{const t=te(e.name);return r(I.Provider,{value:()=>t,children:e.children})},L=({children:e,...t})=>{const o=ne(t);return r(j.Provider,{value:()=>o,children:e})},T=d.createContext(()=>{throw new Error("context not provided")}),_=e=>{const t=N(),[o,a]=d.useState(!1),s=d.useRef(),i=l=>f=>{if(!s.current)return;f.preventDefault();const E=t.data.findIndex(h=>h.id===s.current),w=t.data.findIndex(h=>h.id===l.id);if(E!==w){const h=[...t.data];h.splice(w,0,h.splice(E,1)[0]),t.setData(h)}},n=l=>{l.preventDefault(),a(!1)},c=l=>f=>{if(!o){f.preventDefault();return}f.dataTransfer.effectAllowed="move",s.current=l.id};return r(R,{children:t.data.map(l=>r(T.Provider,{value:a,children:r(I.Provider,{value:()=>t.makeRecordHelpers(l),children:r(R,{draggable:o,onDrop:n,onDragOver:i(l),onDragStart:c(l),style:{userSelect:"text"},children:e.children})})},l.id))})},ae=e=>{const t=d.useContext(T);return r("div",{tabIndex:-1,...e,onMouseDown:()=>t(!0),style:{cursor:"move",backgroundImage:"radial-gradient(circle at 1px 1px, #aaa 1px, transparent 0), radial-gradient(circle at 4px 4px, #aaa 1px, transparent 0)",backgroundSize:"5px 6px",height:"11px",width:"11px",...e.style}})},A=e=>{const t=p(),o=N();return r("button",{...e,onClick:a=>{var s;o.removeRecord(t.data.id),(s=e.onClick)==null||s.call(e,a)},type:"button"})},M=e=>{const t=N();return r("button",{...e,onClick:o=>{var a;t.addRecord(),(a=e.onClick)==null||a.call(e,o)},type:"button"})},ye=()=>{const t=v({name:"Test McTesterson"}),[o,a]=d.useState({});return m(C,{state:t,onSubmit:s=>a(s),children:[r(b,{name:"name",label:"Name"}),r(F,{}),r("pre",{children:JSON.stringify(o,null,2)})]})},V=g(R)`
  display: flex;
  flex-direction: row;

  > *:not(:first-child) {
    margin-top: 0;
    margin-left: 5px;
  }
`,Ie=()=>{const t=v({name:"Test McTesterson",interests:[{interest:"sleeping"}]}),[o,a]=d.useState({}),[s,i]=d.useState(!1);return m(C,{state:t,onSubmit:n=>a(n),children:[r(b,{name:"name",label:"Name"}),r(G,{name:"sortable",label:"Sortable",onChangeValue:n=>i(!!n)}),m(L,{name:"interests",children:[r(_,{children:m(V,{children:[s?r(ae,{style:{height:"auto"}}):null,r(b,{name:"interest",label:"Interest"}),r(A,{children:"remove interest"})]})}),r(M,{children:"add interest"})]}),r(F,{}),r("pre",{children:JSON.stringify(o,null,2)})]})},Ce=()=>{const t=v({name:"Test McTesterson"});return m(C,{state:t,children:[r(b,{name:"name",label:"Name"}),r(F,{}),r(k,{name:"name",children:o=>r("pre",{children:JSON.stringify(o,null,2)})}),r(y,{children:o=>r("pre",{children:JSON.stringify(o,null,2)})})]})},Fe=()=>{const t=v({name:"Test McTesterson",interests:[{interest:"sleeping"}],address:{line1:"1 main st"}});return m(C,{state:t,children:[r(b,{name:"name",label:"Name"}),m("p",{children:["in a loop or namespace ",r("code",{children:"Forms.GetFormData"})," and ",r("code",{children:"Forms.GetFormValue"})," will return only values within the namespace"]}),r(y,{children:o=>m(J,{children:[m(se,{name:"address",children:[r(b,{name:"line1",label:"line1"}),r(y,{children:a=>r("pre",{children:JSON.stringify(a,null,2)})}),r("p",{children:"if you need the parent context data in a subcomponent, you can wrap the entire section"}),r("pre",{children:JSON.stringify(o,null,2)})]}),m(L,{name:"interests",children:[m(_,{children:[m(V,{children:[r(b,{name:"interest",label:"Interest"}),r(A,{children:"remove interest"})]}),r(y,{children:a=>r("pre",{children:JSON.stringify(a,null,2)})})]}),r(M,{children:"add interest"})]}),r(F,{}),r(k,{name:"name",children:a=>r("pre",{children:JSON.stringify(a,null,2)})})]})})]})};typeof window<"u"&&window.document&&window.document.createElement&&document.documentElement.setAttribute("data-storyloaded","");export{ye as BasicControlledForm,Ce as BasicDataReferences,Fe as DataReferencesInNamespaces,Ie as FormRepeatableElements};
