import{r as d,s as x,c as p,d as w,e as D,f as S}from"./Collection.module.44685a59.js";import{$}from"./context.module.3e39767d.js";import{r as c}from"./index.8f51e422.js";import{f as N}from"./useFocusRing.module.eb7e2819.js";function W(r,e){let t=r;for(d(t,e)&&(t=t.parentElement);t&&!d(t,e);)t=t.parentElement;return t||document.scrollingElement||document.documentElement}const R=Symbol.for("react-aria.i18n.locale"),M=Symbol.for("react-aria.i18n.strings");let u;class h{getStringForLocale(e,t){let i=this.getStringsForLocale(t)[e];if(!i)throw new Error(`Could not find intl message ${e} in ${t} locale`);return i}getStringsForLocale(e){let t=this.strings[e];return t||(t=L(e,this.strings,this.defaultLocale),this.strings[e]=t),t}static getGlobalDictionaryForPackage(e){if(typeof window>"u")return null;let t=window[R];if(u===void 0){let i=window[M];if(!i)return null;u={};for(let n in i)u[n]=new h({[t]:i[n]},t)}let l=u==null?void 0:u[e];if(!l)throw new Error(`Strings for package "${e}" were not included by LocalizedStringProvider. Please add it to the list passed to createLocalizedStringDictionary.`);return l}constructor(e,t="en-US"){this.strings=Object.fromEntries(Object.entries(e).filter(([,l])=>l)),this.defaultLocale=t}}function L(r,e,t="en-US"){if(e[r])return e[r];let l=C(r);if(e[l])return e[l];for(let i in e)if(i.startsWith(l+"-"))return e[i];return e[t]}function C(r){return Intl.Locale?new Intl.Locale(r).language:r.split("-")[0]}const g=new Map,y=new Map;class _{format(e,t){let l=this.strings.getStringForLocale(e,this.locale);return typeof l=="function"?l(t,this):l}plural(e,t,l="cardinal"){let i=t["="+e];if(i)return typeof i=="function"?i():i;let n=this.locale+":"+l,a=g.get(n);a||(a=new Intl.PluralRules(this.locale,{type:l}),g.set(n,a));let o=a.select(e);return i=t[o]||t.other,typeof i=="function"?i():i}number(e){let t=y.get(this.locale);return t||(t=new Intl.NumberFormat(this.locale),y.set(this.locale,t)),t.format(e)}select(e,t){let l=e[t]||e.other;return typeof l=="function"?l():l}constructor(e,t){this.locale=e,this.strings=t}}const b=new WeakMap;function I(r){let e=b.get(r);return e||(e=new h(r),b.set(r,e)),e}function B(r,e){return e&&h.getGlobalDictionaryForPackage(e)||I(r)}function T(r,e){let{locale:t}=$(),l=B(r,e);return c.exports.useMemo(()=>new _(t,l),[t,l])}let f=new Map;function F(r){let{locale:e}=$(),t=e+(r?Object.entries(r).sort((i,n)=>i[0]<n[0]?-1:1).join():"");if(f.has(t))return f.get(t);let l=new Intl.Collator(e,r);return f.set(t,l),l}class K{getItemRect(e){let t=this.ref.current;if(!t)return null;let l=e!=null?x(this.ref,e):null;if(!l)return null;let i=t.getBoundingClientRect(),n=l.getBoundingClientRect();return{x:n.left-i.left+t.scrollLeft,y:n.top-i.top+t.scrollTop,width:n.width,height:n.height}}getContentSize(){let e=this.ref.current;var t,l;return{width:(t=e==null?void 0:e.scrollWidth)!==null&&t!==void 0?t:0,height:(l=e==null?void 0:e.scrollHeight)!==null&&l!==void 0?l:0}}getVisibleRect(){let e=this.ref.current;var t,l,i,n;return{x:(t=e==null?void 0:e.scrollLeft)!==null&&t!==void 0?t:0,y:(l=e==null?void 0:e.scrollTop)!==null&&l!==void 0?l:0,width:(i=e==null?void 0:e.offsetWidth)!==null&&i!==void 0?i:0,height:(n=e==null?void 0:e.offsetHeight)!==null&&n!==void 0?n:0}}constructor(e){this.ref=e}}class k{isDisabled(e){var t;return this.disabledBehavior==="all"&&(((t=e.props)===null||t===void 0?void 0:t.isDisabled)||this.disabledKeys.has(e.key))}findNextNonDisabled(e,t){let l=e;for(;l!=null;){let i=this.collection.getItem(l);if((i==null?void 0:i.type)==="item"&&!this.isDisabled(i))return l;l=t(l)}return null}getNextKey(e){let t=e;return t=this.collection.getKeyAfter(t),this.findNextNonDisabled(t,l=>this.collection.getKeyAfter(l))}getPreviousKey(e){let t=e;return t=this.collection.getKeyBefore(t),this.findNextNonDisabled(t,l=>this.collection.getKeyBefore(l))}findKey(e,t,l){let i=e,n=this.layoutDelegate.getItemRect(i);if(!n||i==null)return null;let a=n;do{if(i=t(i),i==null)break;n=this.layoutDelegate.getItemRect(i)}while(n&&l(a,n)&&i!=null);return i}isSameRow(e,t){return e.y===t.y||e.x!==t.x}isSameColumn(e,t){return e.x===t.x||e.y!==t.y}getKeyBelow(e){return this.layout==="grid"&&this.orientation==="vertical"?this.findKey(e,t=>this.getNextKey(t),this.isSameRow):this.getNextKey(e)}getKeyAbove(e){return this.layout==="grid"&&this.orientation==="vertical"?this.findKey(e,t=>this.getPreviousKey(t),this.isSameRow):this.getPreviousKey(e)}getNextColumn(e,t){return t?this.getPreviousKey(e):this.getNextKey(e)}getKeyRightOf(e){let t=this.direction==="ltr"?"getKeyRightOf":"getKeyLeftOf";return this.layoutDelegate[t]?(e=this.layoutDelegate[t](e),this.findNextNonDisabled(e,l=>this.layoutDelegate[t](l))):this.layout==="grid"?this.orientation==="vertical"?this.getNextColumn(e,this.direction==="rtl"):this.findKey(e,l=>this.getNextColumn(l,this.direction==="rtl"),this.isSameColumn):this.orientation==="horizontal"?this.getNextColumn(e,this.direction==="rtl"):null}getKeyLeftOf(e){let t=this.direction==="ltr"?"getKeyLeftOf":"getKeyRightOf";return this.layoutDelegate[t]?(e=this.layoutDelegate[t](e),this.findNextNonDisabled(e,l=>this.layoutDelegate[t](l))):this.layout==="grid"?this.orientation==="vertical"?this.getNextColumn(e,this.direction==="ltr"):this.findKey(e,l=>this.getNextColumn(l,this.direction==="ltr"),this.isSameColumn):this.orientation==="horizontal"?this.getNextColumn(e,this.direction==="ltr"):null}getFirstKey(){let e=this.collection.getFirstKey();return this.findNextNonDisabled(e,t=>this.collection.getKeyAfter(t))}getLastKey(){let e=this.collection.getLastKey();return this.findNextNonDisabled(e,t=>this.collection.getKeyBefore(t))}getKeyPageAbove(e){let t=this.ref.current,l=this.layoutDelegate.getItemRect(e);if(!l)return null;if(t&&!d(t))return this.getFirstKey();let i=e;if(this.orientation==="horizontal"){let n=Math.max(0,l.x+l.width-this.layoutDelegate.getVisibleRect().width);for(;l&&l.x>n&&i!=null;)i=this.getKeyAbove(i),l=i==null?null:this.layoutDelegate.getItemRect(i)}else{let n=Math.max(0,l.y+l.height-this.layoutDelegate.getVisibleRect().height);for(;l&&l.y>n&&i!=null;)i=this.getKeyAbove(i),l=i==null?null:this.layoutDelegate.getItemRect(i)}return i!=null?i:this.getFirstKey()}getKeyPageBelow(e){let t=this.ref.current,l=this.layoutDelegate.getItemRect(e);if(!l)return null;if(t&&!d(t))return this.getLastKey();let i=e;if(this.orientation==="horizontal"){let n=Math.min(this.layoutDelegate.getContentSize().width,l.y-l.width+this.layoutDelegate.getVisibleRect().width);for(;l&&l.x<n&&i!=null;)i=this.getKeyBelow(i),l=i==null?null:this.layoutDelegate.getItemRect(i)}else{let n=Math.min(this.layoutDelegate.getContentSize().height,l.y-l.height+this.layoutDelegate.getVisibleRect().height);for(;l&&l.y<n&&i!=null;)i=this.getKeyBelow(i),l=i==null?null:this.layoutDelegate.getItemRect(i)}return i!=null?i:this.getLastKey()}getKeyForSearch(e,t){if(!this.collator)return null;let l=this.collection,i=t||this.getFirstKey();for(;i!=null;){let n=l.getItem(i);if(!n)return null;let a=n.textValue.slice(0,e.length);if(n.textValue&&this.collator.compare(a,e)===0)return i;i=this.getNextKey(i)}return null}constructor(...e){if(e.length===1){let t=e[0];this.collection=t.collection,this.ref=t.ref,this.collator=t.collator,this.disabledKeys=t.disabledKeys||new Set,this.disabledBehavior=t.disabledBehavior||"all",this.orientation=t.orientation||"vertical",this.direction=t.direction,this.layout=t.layout||"stack",this.layoutDelegate=t.layoutDelegate||new K(t.ref)}else this.collection=e[0],this.disabledKeys=e[1],this.ref=e[2],this.collator=e[3],this.layout="stack",this.orientation="vertical",this.disabledBehavior="all",this.layoutDelegate=new K(this.ref);this.layout==="stack"&&this.orientation==="vertical"&&(this.getKeyLeftOf=void 0,this.getKeyRightOf=void 0)}}function j(r){let{selectionManager:e,collection:t,disabledKeys:l,ref:i,keyboardDelegate:n,layoutDelegate:a}=r,o=F({usage:"search",sensitivity:"base"}),s=e.disabledBehavior,m=c.exports.useMemo(()=>n||new k({collection:t,disabledKeys:l,disabledBehavior:s,ref:i,collator:o,layoutDelegate:a}),[n,a,t,l,i,o,s]),{collectionProps:v}=p({...r,ref:i,selectionManager:e,keyboardDelegate:m});return{listProps:v}}class E{*[Symbol.iterator](){yield*this.iterable}get size(){return this.keyMap.size}getKeys(){return this.keyMap.keys()}getKeyBefore(e){let t=this.keyMap.get(e);var l;return t&&(l=t.prevKey)!==null&&l!==void 0?l:null}getKeyAfter(e){let t=this.keyMap.get(e);var l;return t&&(l=t.nextKey)!==null&&l!==void 0?l:null}getFirstKey(){return this.firstKey}getLastKey(){return this.lastKey}getItem(e){var t;return(t=this.keyMap.get(e))!==null&&t!==void 0?t:null}at(e){const t=[...this.getKeys()];return this.getItem(t[e])}constructor(e,{expandedKeys:t}={}){this.keyMap=new Map,this.firstKey=null,this.lastKey=null,this.iterable=e,t=t||new Set;let l=o=>{if(this.keyMap.set(o.key,o),o.childNodes&&(o.type==="section"||t.has(o.key)))for(let s of o.childNodes)l(s)};for(let o of e)l(o);let i=null,n=0;for(let[o,s]of this.keyMap)i?(i.nextKey=o,s.prevKey=i.key):(this.firstKey=o,s.prevKey=void 0),s.type==="item"&&(s.index=n++),i=s,i.nextKey=void 0;var a;this.lastKey=(a=i==null?void 0:i.key)!==null&&a!==void 0?a:null}}function H(r){let{onExpandedChange:e}=r,[t,l]=N(r.expandedKeys?new Set(r.expandedKeys):void 0,r.defaultExpandedKeys?new Set(r.defaultExpandedKeys):new Set,e),i=w(r),n=c.exports.useMemo(()=>r.disabledKeys?new Set(r.disabledKeys):new Set,[r.disabledKeys]),a=D(r,c.exports.useCallback(s=>new E(s,{expandedKeys:t}),[t]),null);return c.exports.useEffect(()=>{i.focusedKey!=null&&!a.getItem(i.focusedKey)&&i.setFocusedKey(null)},[a,i.focusedKey]),{collection:a,expandedKeys:t,disabledKeys:n,toggleKey:s=>{l(P(t,s))},setExpandedKeys:l,selectionManager:new S(a,i)}}function P(r,e){let t=new Set(r);return t.has(e)?t.delete(e):t.add(e),t}export{W as $,T as a,j as b,H as c,F as d,k as e};
