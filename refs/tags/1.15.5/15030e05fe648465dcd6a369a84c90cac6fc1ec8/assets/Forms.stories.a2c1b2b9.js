import{s as b,a as n,j as u,R as d,F as M}from"./index.cf24ef3b.js";import{T as V,C as J}from"./inputTypes.7274cfb5.js";import"./Radio.f4bfe224.js";import"./theme.f1fb32ed.js";import"./palette.15e4d008.js";import"./Tooltip.74bb595c.js";import"./OverlayArrow.module.84d9e499.js";import"./context.module.2174a500.js";import"./useButton.module.0dda1c74.js";import"./Info.dfe98dd8.js";import"./Checkbox.42e357e8.js";var S={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.stateHasError=e.stateHasData=e.fetchIdle=e.fetchSuccess=e.fetchError=e.fetchLoading=e.FetchStateType=void 0;var t;(function(i){i.SUCCESS="success",i.ERROR="error",i.LOADING="loading",i.IDLE="idle"})(t=e.FetchStateType||(e.FetchStateType={}));const c=i=>({type:t.LOADING,...i&&"data"in i?{data:i.data}:{}});e.fetchLoading=c;const a=(i,m)=>({...m,type:t.ERROR,error:i});e.fetchError=a;const r=i=>({type:t.SUCCESS,data:i});e.fetchSuccess=r;const o=()=>({type:t.IDLE});e.fetchIdle=o;const s=i=>"data"in i;e.stateHasData=s;const l=i=>"error"in i;e.stateHasError=l})(S);const B=b.form`
  margin: 5px;
  > *:not(:first-child) {
    margin-top: 2rem;
  }

  h3 {
    border-bottom: 1px solid #ccc;
  }
`,x=({children:e,...t})=>n(B,{...t,children:e}),p=b.div`
  > *:not(:first-child) {
    margin-top: 2rem;
  }
`;b.div`
  font-weight: bold;
`;const G=b.div`
  display: flex;
  flex-direction: row;
  justify-content: space-between;
  && {
    margin-top: 3rem;
  }
`,U=e=>u(G,{children:["onCancel"in e?n(K,{onClick:e.onCancel,children:"Cancel"}):null,n(z,{})]}),$=b.input`
`,z=({...e})=>n($,{type:"submit",value:"Submit",...e}),q=b.button`
`,K=({...e})=>n(q,{...e});var O={},H={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ifDefined=e.isPlainObject=e.isNumber=e.isDefined=void 0;const t=o=>o!==void 0;e.isDefined=t;const c=o=>typeof o=="number";e.isNumber=c;const a=o=>o instanceof Object&&o.__proto__.constructor.name==="Object";e.isPlainObject=a;const r=(o,s)=>(0,e.isDefined)(o)?o:s;e.ifDefined=r})(H);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.merge=e.getCommonProperties=void 0;const t=H,c=(r,o)=>Object.keys(r).filter(s=>Object.keys(o).includes(s));e.getCommonProperties=c;const a=(...[r,...o])=>{const s=o.length>0?(0,e.merge)(...o):null;return s?{...r,...s,...(0,e.getCommonProperties)(r,s).reduce((l,i)=>({...l,...(0,t.isPlainObject)(r[i])&&(0,t.isPlainObject)(s[i])?{[i]:(0,e.merge)(r[i],s[i])}:Array.isArray(r[i])&&Array.isArray(s[i])?{[i]:[...r[i],...s[i]]}:{}}),{})}:r};e.merge=a})(O);const w=()=>window.crypto.getRandomValues(new Uint32Array(1))[0].toString(16),y=d.createContext(()=>{throw new Error("form helpers not provided")}),g=()=>d.useContext(y)(),F=e=>({field:a=>r=>{e(o=>({...o,[a]:r}))},fields:e,merge:a=>e(r=>O.merge(r,a))}),Q=(e,t,c)=>{const[a,r]=d.useState("data"in e&&e.data?e.data:t||{}),o=d.useRef(a);o.current=a;const s=d.useCallback(()=>{c==null||c(o.current)},[c]),l={namespace:"form",submit:s,data:a,state:e,setInput:F(r)};return l.rootHelpers=l,l},W=e=>{const t=g(),c=a=>t.setInput.fields(r=>({...r,[e]:a instanceof Function?a(r[e]||{}):a}));return{namespace:t.namespace+"."+e,submit:t.submit,data:t.data[e]||{},rootHelpers:t.rootHelpers,state:t.state,setInput:F(c)}},N=d.createContext(()=>{throw new Error("form list helpers not provided")}),R=()=>d.useContext(N)(),X=({name:e})=>{const t=g(),c=d.useCallback(s=>t.setInput.fields(l=>({...l,[e]:s instanceof Function?s(l[e]||[]):s})),[e,t.setInput]),a=s=>({data:s,rootHelpers:t.rootHelpers,state:t.state,submit:t.submit,namespace:t.namespace+"."+s.id,setInput:F(l=>c(i=>i.map(m=>m.id===s.id?l instanceof Function?l(m):l:m)))}),r=d.useMemo(()=>t.data[e]||[],[e,t.data]),o=d.useMemo(()=>r.every(s=>!!s.id),[r]);return d.useEffect(()=>{o||t.setInput.fields(s=>({...s,[e]:r.map(l=>l.id===void 0?{...l,id:w()}:l)}))},[r,o,e,t.setInput]),{addRecord:s=>t.setInput.fields(l=>({...l,[e]:[...l[e]||[],{id:w(),...s}]})),removeRecord:s=>t.setInput.fields(l=>({...l,[e]:(l[e]||[]).filter(i=>i.id!==s)})),data:o?r:[],rootHelpers:t.rootHelpers,setData:c,makeRecordHelpers:a}},Y=(e,t,c)=>{const{disabled:a,emptyDisabledValue:r}=e,o=d.useRef(),s=d.useRef(c);s.current=c,d.useEffect(()=>{r!==!1&&a&&t&&(o.current=t,s.current(void 0)),r!==!1&&!a&&t===void 0&&t!==o.current&&s.current(o.current)},[a,r,t])},h=e=>{const{data:t,namespace:c,setInput:a}=g(),r=s=>{var l;(l=e.onChangeValue)==null||l.call(e,s),a.field(e.name)(s)},o=t[e.name];return Y(e,o,r),n(V,{...e,name:c+"."+e.name,value:o||"",onChangeValue:r})},C=({children:e,state:t,onSubmit:c,defaultData:a,...r})=>{const o=Q(t,a,c);return n(y.Provider,{value:()=>o,children:n(x,{...r,onSubmit:s=>{s.preventDefault(),o.submit()},children:e})})},I=e=>{const{state:t}=g();return n(U,{...e,state:t})},P=e=>{const{data:t}=g();return e.children(t[e.name])},v=e=>{const{data:t}=g();return e.children(t)},Z=e=>{const t=W(e.name);return n(y.Provider,{value:()=>t,children:e.children})},j=({children:e,...t})=>{const c=X(t);return n(N.Provider,{value:()=>c,children:e})},k=d.createContext(()=>{throw new Error("context not provided")}),L=e=>{const t=R(),[c,a]=d.useState(!1),r=d.useRef(),o=i=>m=>{if(!r.current)return;m.preventDefault();const D=t.data.findIndex(f=>f.id===r.current),E=t.data.findIndex(f=>f.id===i.id);if(D!==E){const f=[...t.data];f.splice(E,0,f.splice(D,1)[0]),t.setData(f)}},s=i=>{i.preventDefault(),a(!1)},l=i=>m=>{if(!c){m.preventDefault();return}m.dataTransfer.effectAllowed="move",r.current=i.id};return n(p,{children:t.data.map(i=>n(k.Provider,{value:a,children:n(y.Provider,{value:()=>t.makeRecordHelpers(i),children:n(p,{draggable:c,onDrop:s,onDragOver:o(i),onDragStart:l(i),style:{userSelect:"text"},children:e.children})})},i.id))})},ee=e=>{const t=d.useContext(k);return n("div",{tabIndex:-1,...e,onMouseDown:()=>t(!0),style:{cursor:"move",backgroundImage:"radial-gradient(circle at 1px 1px, #aaa 1px, transparent 0), radial-gradient(circle at 4px 4px, #aaa 1px, transparent 0)",backgroundSize:"5px 6px",height:"11px",width:"11px",...e.style}})},T=e=>{const t=g(),c=R();return n("button",{...e,onClick:a=>{var r;c.removeRecord(t.data.id),(r=e.onClick)==null||r.call(e,a)},type:"button"})},_=e=>{const t=R();return n("button",{...e,onClick:c=>{var a;t.addRecord(),(a=e.onClick)==null||a.call(e,c)},type:"button"})},me=()=>{const e={name:"Test McTesterson"},t=S.fetchSuccess(e),[c,a]=d.useState({});return u(C,{state:t,onSubmit:r=>a(r),children:[n(h,{name:"name",label:"Name"}),n(I,{}),n("pre",{children:JSON.stringify(c,null,2)})]})},A=b(p)`
  display: flex;
  flex-direction: row;

  > *:not(:first-child) {
    margin-top: 0;
    margin-left: 5px;
  }
`,fe=()=>{const e={name:"Test McTesterson",interests:[{interest:"sleeping"}]},t=S.fetchSuccess(e),[c,a]=d.useState({}),[r,o]=d.useState(!1);return u(C,{state:t,onSubmit:s=>a(s),children:[n(h,{name:"name",label:"Name"}),n(J,{name:"sortable",label:"Sortable",onChangeValue:s=>o(!!s)}),u(j,{name:"interests",children:[n(L,{children:u(A,{children:[r?n(ee,{style:{height:"auto"}}):null,n(h,{name:"interest",label:"Interest"}),n(T,{children:"remove interest"})]})}),n(_,{children:"add interest"})]}),n(I,{}),n("pre",{children:JSON.stringify(c,null,2)})]})},he=()=>{const e={name:"Test McTesterson"},t=S.fetchSuccess(e);return u(C,{state:t,children:[n(h,{name:"name",label:"Name"}),n(I,{}),n(P,{name:"name",children:c=>n("pre",{children:JSON.stringify(c,null,2)})}),n(v,{children:c=>n("pre",{children:JSON.stringify(c,null,2)})})]})},be=()=>{const e={name:"Test McTesterson",interests:[{interest:"sleeping"}],address:{line1:"1 main st"}},t=S.fetchSuccess(e);return u(C,{state:t,children:[n(h,{name:"name",label:"Name"}),u("p",{children:["in a loop or namespace ",n("code",{children:"Forms.GetFormData"})," and ",n("code",{children:"Forms.GetFormValue"})," will return only values within the namespace"]}),n(v,{children:c=>u(M,{children:[u(Z,{name:"address",children:[n(h,{name:"line1",label:"line1"}),n(v,{children:a=>n("pre",{children:JSON.stringify(a,null,2)})}),n("p",{children:"if you need the parent context data in a subcomponent, you can wrap the entire section"}),n("pre",{children:JSON.stringify(c,null,2)})]}),u(j,{name:"interests",children:[u(L,{children:[u(A,{children:[n(h,{name:"interest",label:"Interest"}),n(T,{children:"remove interest"})]}),n(v,{children:a=>n("pre",{children:JSON.stringify(a,null,2)})})]}),n(_,{children:"add interest"})]}),n(I,{}),n(P,{name:"name",children:a=>n("pre",{children:JSON.stringify(a,null,2)})})]})})]})};typeof window<"u"&&window.document&&window.document.createElement&&document.documentElement.setAttribute("data-storyloaded","");export{me as BasicControlledForm,he as BasicDataReferences,be as DataReferencesInNamespaces,fe as FormRepeatableElements};
