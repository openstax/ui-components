import{r as F,R as P,a as R,j as ne,F as be}from"./index.91345b36.js";import{i as ve,l as _,g as b,b as k,u as ie,t as A,d as G,D as Ne,c as De,e as Ie,G as Be,f as v,h as q,j as se,S as Ge,s as Ye,k as Ue,m as ae,n as ke,o as re,w as Ae,p as Ce,q as we,a as Oe,E as He}from"./Error.e9b34df9.js";const $e=new RegExp("^[ \\t]*([0-9a-f]{32})?-?([0-9a-f]{16})?-?([01])?[ \\t]*$");function Me(n){const e=n.match($e);if(!n||!e)return;let t;return e[3]==="1"?t=!0:e[3]==="0"&&(t=!1),{traceId:e[1],parentSampled:t,parentSpanId:e[2]}}const z="baggage",me="sentry-",Le=/^sentry-/,Fe=8192;function Pe(n){if(!ve(n)&&!Array.isArray(n))return;let e={};if(Array.isArray(n))e=n.reduce((i,s)=>{const o=oe(s);return{...i,...o}},{});else{if(!n)return;e=oe(n)}const t=Object.entries(e).reduce((i,[s,o])=>{if(s.match(Le)){const a=s.slice(me.length);i[a]=o}return i},{});if(Object.keys(t).length>0)return t}function ge(n){const e=Object.entries(n).reduce((t,[i,s])=>(s&&(t[`${me}${i}`]=s),t),{});return xe(e)}function oe(n){return n.split(",").map(e=>e.split("=").map(t=>decodeURIComponent(t.trim()))).reduce((e,[t,i])=>(e[t]=i,e),{})}function xe(n){if(Object.keys(n).length!==0)return Object.entries(n).reduce((e,[t,i],s)=>{const o=`${encodeURIComponent(t)}=${encodeURIComponent(i)}`,a=s===0?o:`${e},${o}`;return a.length>Fe?((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.warn(`Not adding key: ${t} with val: ${i} to baggage header due to exceeding baggage size limits.`),e):a},"")}function J(n){if(typeof __SENTRY_TRACING__=="boolean"&&!__SENTRY_TRACING__)return!1;const e=b().getClient(),t=n||e&&e.getOptions();return!!t&&(t.enableTracing||"tracesSampleRate"in t||"tracesSampler"in t)}function C(n){return(n||b()).getScope().getTransaction()}let ce=!1;function je(){ce||(ce=!0,k("error",W),k("unhandledrejection",W))}function W(){const n=C();if(n){const e="internal_error";(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.log(`[Tracing] Transaction: ${e} -> Global error occured`),n.setStatus(e)}}W.tag="sentry_tracingErrorCallback";class M{__init(){this.spans=[]}constructor(e=1e3){M.prototype.__init.call(this),this._maxlen=e}add(e){this.spans.length>this._maxlen?e.spanRecorder=void 0:this.spans.push(e)}}class T{__init2(){this.traceId=ie()}__init3(){this.spanId=ie().substring(16)}__init4(){this.startTimestamp=A()}__init5(){this.tags={}}__init6(){this.data={}}__init7(){this.instrumenter="sentry"}constructor(e){if(T.prototype.__init2.call(this),T.prototype.__init3.call(this),T.prototype.__init4.call(this),T.prototype.__init5.call(this),T.prototype.__init6.call(this),T.prototype.__init7.call(this),!e)return this;e.traceId&&(this.traceId=e.traceId),e.spanId&&(this.spanId=e.spanId),e.parentSpanId&&(this.parentSpanId=e.parentSpanId),"sampled"in e&&(this.sampled=e.sampled),e.op&&(this.op=e.op),e.description&&(this.description=e.description),e.data&&(this.data=e.data),e.tags&&(this.tags=e.tags),e.status&&(this.status=e.status),e.startTimestamp&&(this.startTimestamp=e.startTimestamp),e.endTimestamp&&(this.endTimestamp=e.endTimestamp),e.instrumenter&&(this.instrumenter=e.instrumenter)}startChild(e){const t=new T({...e,parentSpanId:this.spanId,sampled:this.sampled,traceId:this.traceId});if(t.spanRecorder=this.spanRecorder,t.spanRecorder&&t.spanRecorder.add(t),t.transaction=this.transaction,(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&t.transaction){const i=e&&e.op||"< unknown op >",s=t.transaction.name||"< unknown name >",o=t.transaction.spanId,a=`[Tracing] Starting '${i}' span on transaction '${s}' (${o}).`;t.transaction.metadata.spanMetadata[t.spanId]={logMessage:a},_.log(a)}return t}setTag(e,t){return this.tags={...this.tags,[e]:t},this}setData(e,t){return this.data={...this.data,[e]:t},this}setStatus(e){return this.status=e,this}setHttpStatus(e){this.setTag("http.status_code",String(e));const t=qe(e);return t!=="unknown_error"&&this.setStatus(t),this}isSuccess(){return this.status==="ok"}finish(e){if((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&this.transaction&&this.transaction.spanId!==this.spanId){const{logMessage:t}=this.transaction.metadata.spanMetadata[this.spanId];t&&_.log(t.replace("Starting","Finishing"))}this.endTimestamp=typeof e=="number"?e:A()}toTraceparent(){let e="";return this.sampled!==void 0&&(e=this.sampled?"-1":"-0"),`${this.traceId}-${this.spanId}${e}`}toContext(){return G({data:this.data,description:this.description,endTimestamp:this.endTimestamp,op:this.op,parentSpanId:this.parentSpanId,sampled:this.sampled,spanId:this.spanId,startTimestamp:this.startTimestamp,status:this.status,tags:this.tags,traceId:this.traceId})}updateWithContext(e){return this.data=e.data||{},this.description=e.description,this.endTimestamp=e.endTimestamp,this.op=e.op,this.parentSpanId=e.parentSpanId,this.sampled=e.sampled,this.spanId=e.spanId||this.spanId,this.startTimestamp=e.startTimestamp||this.startTimestamp,this.status=e.status,this.tags=e.tags||{},this.traceId=e.traceId||this.traceId,this}getTraceContext(){return G({data:Object.keys(this.data).length>0?this.data:void 0,description:this.description,op:this.op,parent_span_id:this.parentSpanId,span_id:this.spanId,status:this.status,tags:Object.keys(this.tags).length>0?this.tags:void 0,trace_id:this.traceId})}toJSON(){return G({data:Object.keys(this.data).length>0?this.data:void 0,description:this.description,op:this.op,parent_span_id:this.parentSpanId,span_id:this.spanId,start_timestamp:this.startTimestamp,status:this.status,tags:Object.keys(this.tags).length>0?this.tags:void 0,timestamp:this.endTimestamp,trace_id:this.traceId})}}function qe(n){if(n<400&&n>=100)return"ok";if(n>=400&&n<500)switch(n){case 401:return"unauthenticated";case 403:return"permission_denied";case 404:return"not_found";case 409:return"already_exists";case 413:return"failed_precondition";case 429:return"resource_exhausted";default:return"invalid_argument"}if(n>=500&&n<600)switch(n){case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline_exceeded";default:return"internal_error"}return"unknown_error"}class I extends T{__init(){this._measurements={}}__init2(){this._contexts={}}__init3(){this._frozenDynamicSamplingContext=void 0}constructor(e,t){super(e),I.prototype.__init.call(this),I.prototype.__init2.call(this),I.prototype.__init3.call(this),this._hub=t||b(),this._name=e.name||"",this.metadata={source:"custom",...e.metadata,spanMetadata:{}},this._trimEnd=e.trimEnd,this.transaction=this;const i=this.metadata.dynamicSamplingContext;i&&(this._frozenDynamicSamplingContext={...i})}get name(){return this._name}set name(e){this.setName(e)}setName(e,t="custom"){this._name=e,this.metadata.source=t}initSpanRecorder(e=1e3){this.spanRecorder||(this.spanRecorder=new M(e)),this.spanRecorder.add(this)}setContext(e,t){t===null?delete this._contexts[e]:this._contexts[e]=t}setMeasurement(e,t,i=""){this._measurements[e]={value:t,unit:i}}setMetadata(e){this.metadata={...this.metadata,...e}}finish(e){if(this.endTimestamp!==void 0)return;this.name||((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.warn("Transaction has no name, falling back to `<unlabeled transaction>`."),this.name="<unlabeled transaction>"),super.finish(e);const t=this._hub.getClient();if(t&&t.emit&&t.emit("finishTransaction",this),this.sampled!==!0){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.log("[Tracing] Discarding transaction because its trace was not chosen to be sampled."),t&&t.recordDroppedEvent("sample_rate","transaction");return}const i=this.spanRecorder?this.spanRecorder.spans.filter(r=>r!==this&&r.endTimestamp):[];this._trimEnd&&i.length>0&&(this.endTimestamp=i.reduce((r,c)=>r.endTimestamp&&c.endTimestamp?r.endTimestamp>c.endTimestamp?r:c:r).endTimestamp);const s=this.metadata,o={contexts:{...this._contexts,trace:this.getTraceContext()},spans:i,start_timestamp:this.startTimestamp,tags:this.tags,timestamp:this.endTimestamp,transaction:this.name,type:"transaction",sdkProcessingMetadata:{...s,dynamicSamplingContext:this.getDynamicSamplingContext()},...s.source&&{transaction_info:{source:s.source}}};return Object.keys(this._measurements).length>0&&((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.log("[Measurements] Adding measurements to transaction",JSON.stringify(this._measurements,void 0,2)),o.measurements=this._measurements),(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.log(`[Tracing] Finishing ${this.op} transaction: ${this.name}.`),this._hub.captureEvent(o)}toContext(){const e=super.toContext();return G({...e,name:this.name,trimEnd:this._trimEnd})}updateWithContext(e){return super.updateWithContext(e),this.name=e.name||"",this._trimEnd=e.trimEnd,this}getDynamicSamplingContext(){if(this._frozenDynamicSamplingContext)return this._frozenDynamicSamplingContext;const e=this._hub||b(),t=e&&e.getClient();if(!t)return{};const{environment:i,release:s}=t.getOptions()||{},{publicKey:o}=t.getDsn()||{},a=this.metadata.sampleRate,r=a!==void 0?a.toString():void 0,{segment:c}=e.getScope().getUser()||{},d=this.metadata.source,l=d&&d!=="url"?this.name:void 0,m=G({environment:i||Ne,release:s,transaction:l,user_segment:c,public_key:o,trace_id:this.traceId,sample_rate:r});return t.emit&&t.emit("createDsc",m),m}setHub(e){this._hub=e}}const H={idleTimeout:1e3,finalTimeout:3e4,heartbeatInterval:5e3},ze="finishReason",D=["heartbeatFailed","idleTimeout","documentHidden","finalTimeout","externalFinish","cancelled"];class We extends M{constructor(e,t,i,s){super(s),this._pushActivity=e,this._popActivity=t,this.transactionSpanId=i}add(e){e.spanId!==this.transactionSpanId&&(e.finish=t=>{e.endTimestamp=typeof t=="number"?t:A(),this._popActivity(e.spanId)},e.endTimestamp===void 0&&this._pushActivity(e.spanId)),super.add(e)}}class S extends I{__init(){this.activities={}}__init2(){this._heartbeatCounter=0}__init3(){this._finished=!1}__init4(){this._idleTimeoutCanceledPermanently=!1}__init5(){this._beforeFinishCallbacks=[]}__init6(){this._finishReason=D[4]}constructor(e,t,i=H.idleTimeout,s=H.finalTimeout,o=H.heartbeatInterval,a=!1){super(e,t),this._idleHub=t,this._idleTimeout=i,this._finalTimeout=s,this._heartbeatInterval=o,this._onScope=a,S.prototype.__init.call(this),S.prototype.__init2.call(this),S.prototype.__init3.call(this),S.prototype.__init4.call(this),S.prototype.__init5.call(this),S.prototype.__init6.call(this),a&&((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.log(`Setting idle transaction on scope. Span ID: ${this.spanId}`),t.configureScope(r=>r.setSpan(this))),this._restartIdleTimeout(),setTimeout(()=>{this._finished||(this.setStatus("deadline_exceeded"),this._finishReason=D[3],this.finish())},this._finalTimeout)}finish(e=A()){if(this._finished=!0,this.activities={},this.op==="ui.action.click"&&this.setTag(ze,this._finishReason),this.spanRecorder){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.log("[Tracing] finishing IdleTransaction",new Date(e*1e3).toISOString(),this.op);for(const t of this._beforeFinishCallbacks)t(this,e);this.spanRecorder.spans=this.spanRecorder.spans.filter(t=>{if(t.spanId===this.spanId)return!0;t.endTimestamp||(t.endTimestamp=e,t.setStatus("cancelled"),(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.log("[Tracing] cancelling span since transaction ended early",JSON.stringify(t,void 0,2)));const i=t.startTimestamp<e;return i||(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.log("[Tracing] discarding Span since it happened after Transaction was finished",JSON.stringify(t,void 0,2)),i}),(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.log("[Tracing] flushing IdleTransaction")}else(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.log("[Tracing] No active IdleTransaction");if(this._onScope){const t=this._idleHub.getScope();t.getTransaction()===this&&t.setSpan(void 0)}return super.finish(e)}registerBeforeFinishCallback(e){this._beforeFinishCallbacks.push(e)}initSpanRecorder(e){if(!this.spanRecorder){const t=s=>{this._finished||this._pushActivity(s)},i=s=>{this._finished||this._popActivity(s)};this.spanRecorder=new We(t,i,this.spanId,e),(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.log("Starting heartbeat"),this._pingHeartbeat()}this.spanRecorder.add(this)}cancelIdleTimeout(e,{restartOnChildSpanChange:t}={restartOnChildSpanChange:!0}){this._idleTimeoutCanceledPermanently=t===!1,this._idleTimeoutID&&(clearTimeout(this._idleTimeoutID),this._idleTimeoutID=void 0,Object.keys(this.activities).length===0&&this._idleTimeoutCanceledPermanently&&(this._finishReason=D[5],this.finish(e)))}setFinishReason(e){this._finishReason=e}_restartIdleTimeout(e){this.cancelIdleTimeout(),this._idleTimeoutID=setTimeout(()=>{!this._finished&&Object.keys(this.activities).length===0&&(this._finishReason=D[1],this.finish(e))},this._idleTimeout)}_pushActivity(e){this.cancelIdleTimeout(void 0,{restartOnChildSpanChange:!this._idleTimeoutCanceledPermanently}),(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.log(`[Tracing] pushActivity: ${e}`),this.activities[e]=!0,(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.log("[Tracing] new activities count",Object.keys(this.activities).length)}_popActivity(e){if(this.activities[e]&&((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.log(`[Tracing] popActivity ${e}`),delete this.activities[e],(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.log("[Tracing] new activities count",Object.keys(this.activities).length)),Object.keys(this.activities).length===0){const t=A();this._idleTimeoutCanceledPermanently?(this._finishReason=D[5],this.finish(t)):this._restartIdleTimeout(t+this._idleTimeout/1e3)}}_beat(){if(this._finished)return;const e=Object.keys(this.activities).join("");e===this._prevHeartbeatString?this._heartbeatCounter++:this._heartbeatCounter=1,this._prevHeartbeatString=e,this._heartbeatCounter>=3?((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.log("[Tracing] Transaction finished because of no change for 3 heart beats"),this.setStatus("deadline_exceeded"),this._finishReason=D[0],this.finish()):this._pingHeartbeat()}_pingHeartbeat(){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.log(`pinging Heartbeat -> current counter: ${this._heartbeatCounter}`),setTimeout(()=>{this._beat()},this._heartbeatInterval)}}function Ve(){const e=this.getScope().getSpan();return e?{"sentry-trace":e.toTraceparent()}:{}}function Te(n,e,t){if(!J(e))return n.sampled=!1,n;if(n.sampled!==void 0)return n.setMetadata({sampleRate:Number(n.sampled)}),n;let i;return typeof e.tracesSampler=="function"?(i=e.tracesSampler(t),n.setMetadata({sampleRate:Number(i)})):t.parentSampled!==void 0?i=t.parentSampled:typeof e.tracesSampleRate<"u"?(i=e.tracesSampleRate,n.setMetadata({sampleRate:Number(i)})):(i=1,n.setMetadata({sampleRate:i})),Xe(i)?i?(n.sampled=Math.random()<i,n.sampled?((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.log(`[Tracing] starting ${n.op} transaction - ${n.name}`),n):((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.log(`[Tracing] Discarding transaction because it's not included in the random sample (sampling rate = ${Number(i)})`),n)):((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.log(`[Tracing] Discarding transaction because ${typeof e.tracesSampler=="function"?"tracesSampler returned 0 or false":"a negative sampling decision was inherited or tracesSampleRate is set to 0"}`),n.sampled=!1,n):((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.warn("[Tracing] Discarding transaction because of invalid sample rate."),n.sampled=!1,n)}function Xe(n){return Ie(n)||!(typeof n=="number"||typeof n=="boolean")?((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.warn(`[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(n)} of type ${JSON.stringify(typeof n)}.`),!1):n<0||n>1?((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.warn(`[Tracing] Given sample rate is invalid. Sample rate must be between 0 and 1. Got ${n}.`),!1):!0}function Je(n,e){const t=this.getClient(),i=t&&t.getOptions()||{},s=i.instrumenter||"sentry",o=n.instrumenter||"sentry";s!==o&&((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.error(`A transaction was started with instrumenter=\`${o}\`, but the SDK is configured with the \`${s}\` instrumenter.
The transaction will not be sampled. Please use the ${s} instrumentation to start transactions.`),n.sampled=!1);let a=new I(n,this);return a=Te(a,i,{parentSampled:n.parentSampled,transactionContext:n,...e}),a.sampled&&a.initSpanRecorder(i._experiments&&i._experiments.maxSpans),t&&t.emit&&t.emit("startTransaction",a),a}function de(n,e,t,i,s,o,a){const r=n.getClient(),c=r&&r.getOptions()||{};let d=new S(e,n,t,i,a,s);return d=Te(d,c,{parentSampled:e.parentSampled,transactionContext:e,...o}),d.sampled&&d.initSpanRecorder(c._experiments&&c._experiments.maxSpans),r&&r.emit&&r.emit("startTransaction",d),d}function Ke(){const n=De();!n.__SENTRY__||(n.__SENTRY__.extensions=n.__SENTRY__.extensions||{},n.__SENTRY__.extensions.startTransaction||(n.__SENTRY__.extensions.startTransaction=Je),n.__SENTRY__.extensions.traceHeaders||(n.__SENTRY__.extensions.traceHeaders=Ve),je())}const u=Be;function Qe(){u&&u.document?u.document.addEventListener("visibilitychange",()=>{const n=C();if(u.document.hidden&&n){const e="cancelled";(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.log(`[Tracing] Transaction: ${e} -> since tab moved to the background, op: ${n.op}`),n.status||n.setStatus(e),n.setTag("visibilitychange","document.hidden"),n.finish()}}):(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.warn("[Tracing] Could not set up background tab detection due to lack of window document")}const K=(n,e,t)=>{let i,s;return o=>{e.value>=0&&(o||t)&&(s=e.value-(i||0),(s||i===void 0)&&(i=e.value,e.delta=s,n(e)))}},Ze=()=>`v3-${Date.now()}-${Math.floor(Math.random()*(9e12-1))+1e12}`,et=()=>{const n=u.performance.timing,e=u.performance.navigation.type,t={entryType:"navigation",startTime:0,type:e==2?"back_forward":e===1?"reload":"navigate"};for(const i in n)i!=="navigationStart"&&i!=="toJSON"&&(t[i]=Math.max(n[i]-n.navigationStart,0));return t},Ee=()=>u.__WEB_VITALS_POLYFILL__?u.performance&&(performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]||et()):u.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0],Se=()=>{const n=Ee();return n&&n.activationStart||0},Q=(n,e)=>{const t=Ee();let i="navigate";return t&&(u.document.prerendering||Se()>0?i="prerender":i=t.type.replace(/_/g,"-")),{name:n,value:typeof e>"u"?-1:e,rating:"good",delta:0,entries:[],id:Ze(),navigationType:i}},w=(n,e,t)=>{try{if(PerformanceObserver.supportedEntryTypes.includes(n)){const i=new PerformanceObserver(s=>{e(s.getEntries())});return i.observe(Object.assign({type:n,buffered:!0},t||{})),i}}catch{}},L=(n,e)=>{const t=i=>{(i.type==="pagehide"||u.document.visibilityState==="hidden")&&(n(i),e&&(removeEventListener("visibilitychange",t,!0),removeEventListener("pagehide",t,!0)))};addEventListener("visibilitychange",t,!0),addEventListener("pagehide",t,!0)},tt=n=>{const e=Q("CLS",0);let t,i=0,s=[];const o=r=>{r.forEach(c=>{if(!c.hadRecentInput){const d=s[0],l=s[s.length-1];i&&s.length!==0&&c.startTime-l.startTime<1e3&&c.startTime-d.startTime<5e3?(i+=c.value,s.push(c)):(i=c.value,s=[c]),i>e.value&&(e.value=i,e.entries=s,t&&t())}})},a=w("layout-shift",o);if(a){t=K(n,e);const r=()=>{o(a.takeRecords()),t(!0)};return L(r),r}};let $=-1;const nt=()=>u.document.visibilityState==="hidden"&&!u.document.prerendering?0:1/0,it=()=>{L(({timeStamp:n})=>{$=n},!0)},Z=()=>($<0&&($=nt(),it()),{get firstHiddenTime(){return $}}),st=n=>{const e=Z(),t=Q("FID");let i;const s=r=>{r.startTime<e.firstHiddenTime&&(t.value=r.processingStart-r.startTime,t.entries.push(r),i(!0))},o=r=>{r.forEach(s)},a=w("first-input",o);i=K(n,t),a&&L(()=>{o(a.takeRecords()),a.disconnect()},!0)},_e={},at=n=>{const e=Z(),t=Q("LCP");let i;const s=a=>{const r=a[a.length-1];if(r){const c=Math.max(r.startTime-Se(),0);c<e.firstHiddenTime&&(t.value=c,t.entries=[r],i())}},o=w("largest-contentful-paint",s);if(o){i=K(n,t);const a=()=>{_e[t.id]||(s(o.takeRecords()),o.disconnect(),_e[t.id]=!0,i(!0))};return["keydown","click"].forEach(r=>{addEventListener(r,a,{once:!0,capture:!0})}),L(a,!0),a}};function x(n){return typeof n=="number"&&isFinite(n)}function B(n,{startTimestamp:e,...t}){return e&&n.startTimestamp>e&&(n.startTimestamp=e),n.startChild({startTimestamp:e,...t})}function h(n){return n/1e3}function ye(){return u&&u.addEventListener&&u.performance}let ue=0,p={},g,Y;function rt(){const n=ye();if(n&&v){n.mark&&u.performance.mark("sentry-tracing-init"),ut();const e=dt(),t=_t();return()=>{e&&e(),t&&t()}}return()=>{}}function ot(){w("longtask",e=>{for(const t of e){const i=C();if(!i)return;const s=h(v+t.startTime),o=h(t.duration);i.startChild({description:"Main UI thread blocked",op:"ui.long-task",startTimestamp:s,endTimestamp:s+o})}})}function ct(){w("event",e=>{for(const t of e){const i=C();if(!i)return;if(t.name==="click"){const s=h(v+t.startTime),o=h(t.duration);i.startChild({description:q(t.target),op:`ui.interaction.${t.name}`,startTimestamp:s,endTimestamp:s+o})}}},{durationThreshold:0})}function dt(){return tt(n=>{const e=n.entries.pop();!e||((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.log("[Measurements] Adding CLS"),p.cls={value:n.value,unit:""},Y=e)})}function _t(){return at(n=>{const e=n.entries.pop();!e||((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.log("[Measurements] Adding LCP"),p.lcp={value:n.value,unit:"millisecond"},g=e)})}function ut(){st(n=>{const e=n.entries.pop();if(!e)return;const t=h(v),i=h(e.startTime);(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.log("[Measurements] Adding FID"),p.fid={value:n.value,unit:"millisecond"},p["mark.fid"]={value:t+i,unit:"second"}})}function lt(n){const e=ye();if(!e||!u.performance.getEntries||!v)return;(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.log("[Tracing] Adding & adjusting spans using Performance API");const t=h(v),i=e.getEntries();let s,o;if(i.slice(ue).forEach(a=>{const r=h(a.startTime),c=h(a.duration);if(!(n.op==="navigation"&&t+r<n.startTimestamp))switch(a.entryType){case"navigation":{ft(n,a,t),s=t+h(a.responseStart),o=t+h(a.requestStart);break}case"mark":case"paint":case"measure":{pt(n,a,r,c,t);const d=Z(),l=a.startTime<d.firstHiddenTime;a.name==="first-paint"&&l&&((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.log("[Measurements] Adding FP"),p.fp={value:a.startTime,unit:"millisecond"}),a.name==="first-contentful-paint"&&l&&((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.log("[Measurements] Adding FCP"),p.fcp={value:a.startTime,unit:"millisecond"});break}case"resource":{const d=a.name.replace(u.location.origin,"");mt(n,a,d,r,c,t);break}}}),ue=Math.max(i.length-1,0),gt(n),n.op==="pageload"){typeof s=="number"&&((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.log("[Measurements] Adding TTFB"),p.ttfb={value:(s-n.startTimestamp)*1e3,unit:"millisecond"},typeof o=="number"&&o<=s&&(p["ttfb.requestTime"]={value:(s-o)*1e3,unit:"millisecond"})),["fcp","fp","lcp"].forEach(r=>{if(!p[r]||t>=n.startTimestamp)return;const c=p[r].value,d=t+h(c),l=Math.abs((d-n.startTimestamp)*1e3),m=l-c;(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.log(`[Measurements] Normalized ${r} from ${c} to ${l} (${m})`),p[r].value=l});const a=p["mark.fid"];a&&p.fid&&(B(n,{description:"first input delay",endTimestamp:a.value+h(p.fid.value),op:"ui.action",startTimestamp:a.value}),delete p["mark.fid"]),"fcp"in p||delete p.cls,Object.keys(p).forEach(r=>{n.setMeasurement(r,p[r].value,p[r].unit)}),Tt(n)}g=void 0,Y=void 0,p={}}function pt(n,e,t,i,s){const o=s+t,a=o+i;return B(n,{description:e.name,endTimestamp:a,op:e.entryType,startTimestamp:o}),o}function ft(n,e,t){["unloadEvent","redirect","domContentLoadedEvent","loadEvent","connect"].forEach(i=>{O(n,e,i,t)}),O(n,e,"secureConnection",t,"TLS/SSL","connectEnd"),O(n,e,"fetch",t,"cache","domainLookupStart"),O(n,e,"domainLookup",t,"DNS"),ht(n,e,t)}function O(n,e,t,i,s,o){const a=o?e[o]:e[`${t}End`],r=e[`${t}Start`];!r||!a||B(n,{op:"browser",description:s||t,startTimestamp:i+h(r),endTimestamp:i+h(a)})}function ht(n,e,t){B(n,{op:"browser",description:"request",startTimestamp:t+h(e.requestStart),endTimestamp:t+h(e.responseEnd)}),B(n,{op:"browser",description:"response",startTimestamp:t+h(e.responseStart),endTimestamp:t+h(e.responseEnd)})}function mt(n,e,t,i,s,o){if(e.initiatorType==="xmlhttprequest"||e.initiatorType==="fetch")return;const a={};"transferSize"in e&&(a["Transfer Size"]=e.transferSize),"encodedBodySize"in e&&(a["Encoded Body Size"]=e.encodedBodySize),"decodedBodySize"in e&&(a["Decoded Body Size"]=e.decodedBodySize),"renderBlockingStatus"in e&&(a["resource.render_blocking_status"]=e.renderBlockingStatus);const r=o+i,c=r+s;B(n,{description:t,endTimestamp:c,op:e.initiatorType?`resource.${e.initiatorType}`:"resource.other",startTimestamp:r,data:a})}function gt(n){const e=u.navigator;if(!e)return;const t=e.connection;t&&(t.effectiveType&&n.setTag("effectiveConnectionType",t.effectiveType),t.type&&n.setTag("connectionType",t.type),x(t.rtt)&&(p["connection.rtt"]={value:t.rtt,unit:"millisecond"})),x(e.deviceMemory)&&n.setTag("deviceMemory",`${e.deviceMemory} GB`),x(e.hardwareConcurrency)&&n.setTag("hardwareConcurrency",String(e.hardwareConcurrency))}function Tt(n){g&&((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.log("[Measurements] Adding LCP Data"),g.element&&n.setTag("lcp.element",q(g.element)),g.id&&n.setTag("lcp.id",g.id),g.url&&n.setTag("lcp.url",g.url.trim().slice(0,200)),n.setTag("lcp.size",g.size)),Y&&Y.sources&&((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.log("[Measurements] Adding CLS Data"),Y.sources.forEach((e,t)=>n.setTag(`cls.source.${t+1}`,q(e.node))))}const V=["localhost",/^\//],X={traceFetch:!0,traceXHR:!0,tracingOrigins:V,tracePropagationTargets:V};function Et(n){const{traceFetch:e,traceXHR:t,tracePropagationTargets:i,tracingOrigins:s,shouldCreateSpanForRequest:o}={traceFetch:X.traceFetch,traceXHR:X.traceXHR,...n},a=typeof o=="function"?o:d=>!0,r=d=>St(d,i||s),c={};e&&k("fetch",d=>{yt(d,a,r,c)}),t&&k("xhr",d=>{bt(d,a,r,c)})}function St(n,e){return Ye(n,e||V)}function yt(n,e,t,i){if(!J()||!(n.fetchData&&e(n.fetchData.url)))return;if(n.endTimestamp){const r=n.fetchData.__span;if(!r)return;const c=i[r];c&&(n.response?c.setHttpStatus(n.response.status):n.error&&c.setStatus("internal_error"),c.finish(),delete i[r]);return}const s=b().getScope(),o=s&&s.getSpan(),a=o&&o.transaction;if(o&&a){const r=o.startChild({data:{...n.fetchData,type:"fetch"},description:`${n.fetchData.method} ${n.fetchData.url}`,op:"http.client"});n.fetchData.__span=r.spanId,i[r.spanId]=r;const c=n.args[0];n.args[1]=n.args[1]||{};const d=n.args[1];t(n.fetchData.url)&&(d.headers=Rt(c,a.getDynamicSamplingContext(),r,d))}}function Rt(n,e,t,i){const s=ge(e),o=t.toTraceparent(),a=typeof Request<"u"&&se(n,Request)?n.headers:i.headers;if(a)if(typeof Headers<"u"&&se(a,Headers)){const r=new Headers(a);return r.append("sentry-trace",o),s&&r.append(z,s),r}else if(Array.isArray(a)){const r=[...a,["sentry-trace",o]];return s&&r.push([z,s]),r}else{const r="baggage"in a?a.baggage:void 0,c=[];return Array.isArray(r)?c.push(...r):r&&c.push(r),s&&c.push(s),{...a,"sentry-trace":o,baggage:c.length>0?c.join(","):void 0}}else return{"sentry-trace":o,baggage:s}}function bt(n,e,t,i){const s=n.xhr,o=s&&s[Ge];if(!J()||s&&s.__sentry_own_request__||!(s&&o&&e(o.url)))return;if(n.endTimestamp){const d=s.__sentry_xhr_span_id__;if(!d)return;const l=i[d];l&&(l.setHttpStatus(o.status_code),l.finish(),delete i[d]);return}const a=b().getScope(),r=a&&a.getSpan(),c=r&&r.transaction;if(r&&c){const d=r.startChild({data:{...o.data,type:"xhr",method:o.method,url:o.url},description:`${o.method} ${o.url}`,op:"http.client"});if(s.__sentry_xhr_span_id__=d.spanId,i[s.__sentry_xhr_span_id__]=d,s.setRequestHeader&&t(o.url))try{s.setRequestHeader("sentry-trace",d.toTraceparent());const l=c.getDynamicSamplingContext(),m=ge(l);m&&s.setRequestHeader(z,m)}catch{}}}function vt(n,e=!0,t=!0){if(!u||!u.location){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.warn("Could not initialize routing instrumentation due to invalid location");return}let i=u.location.href,s;e&&(s=n({name:u.location.pathname,startTimestamp:v,op:"pageload",metadata:{source:"url"}})),t&&k("history",({to:o,from:a})=>{if(a===void 0&&i&&i.indexOf(o)!==-1){i=void 0;return}a!==o&&(i=void 0,s&&((typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.log(`[Tracing] Finishing current transaction with op: ${s.op}`),s.finish()),s=n({name:u.location.pathname,op:"navigation",metadata:{source:"url"}}))})}const Nt="BrowserTracing",Dt={...H,markBackgroundTransactions:!0,routingInstrumentation:vt,startTransactionOnLocationChange:!0,startTransactionOnPageLoad:!0,enableLongTask:!0,_experiments:{},...X};class ee{__init(){this.name=Nt}constructor(e){ee.prototype.__init.call(this),Ke(),this.options={...Dt,...e},this.options._experiments.enableLongTask!==void 0&&(this.options.enableLongTask=this.options._experiments.enableLongTask),e&&!e.tracePropagationTargets&&e.tracingOrigins&&(this.options.tracePropagationTargets=e.tracingOrigins),this._collectWebVitals=rt(),this.options.enableLongTask&&ot(),this.options._experiments.enableInteractions&&ct()}setupOnce(e,t){this._getCurrentHub=t;const{routingInstrumentation:i,startTransactionOnLocationChange:s,startTransactionOnPageLoad:o,markBackgroundTransactions:a,traceFetch:r,traceXHR:c,tracePropagationTargets:d,shouldCreateSpanForRequest:l,_experiments:m}=this.options;i(E=>{const f=this._createRouteTransaction(E);return this.options._experiments.onStartRouteTransaction&&this.options._experiments.onStartRouteTransaction(f,E,t),f},o,s),a&&Qe(),m.enableInteractions&&this._registerInteractionListener(),Et({traceFetch:r,traceXHR:c,tracePropagationTargets:d,shouldCreateSpanForRequest:l})}_createRouteTransaction(e){if(!this._getCurrentHub){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.warn(`[Tracing] Did not create ${e.op} transaction because _getCurrentHub is invalid.`);return}const{beforeNavigate:t,idleTimeout:i,finalTimeout:s,heartbeatInterval:o}=this.options,a=e.op==="pageload",r=a?le("sentry-trace"):null,c=a?le("baggage"):null,d=r?Me(r):void 0,l=c?Pe(c):void 0,m={...e,...d,metadata:{...e.metadata,dynamicSamplingContext:d&&!l?{}:l},trimEnd:!0},E=typeof t=="function"?t(m):m,f=E===void 0?{...m,sampled:!1}:E;f.metadata=f.name!==m.name?{...f.metadata,source:"custom"}:f.metadata,this._latestRouteName=f.name,this._latestRouteSource=f.metadata&&f.metadata.source,f.sampled===!1&&(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.log(`[Tracing] Will not send ${f.op} transaction because of beforeNavigate.`),(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.log(`[Tracing] Starting ${f.op} transaction on scope`);const y=this._getCurrentHub(),{location:N}=u,te=de(y,f,i,s,!0,{location:N},o);return te.registerBeforeFinishCallback(Re=>{this._collectWebVitals(),lt(Re)}),te}_registerInteractionListener(){let e;const t=()=>{const{idleTimeout:i,finalTimeout:s,heartbeatInterval:o}=this.options,a="ui.action.click",r=C();if(r&&r.op&&["navigation","pageload"].includes(r.op)){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.warn(`[Tracing] Did not create ${a} transaction because a pageload or navigation transaction is in progress.`);return}if(e&&(e.setFinishReason("interactionInterrupted"),e.finish(),e=void 0),!this._getCurrentHub){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.warn(`[Tracing] Did not create ${a} transaction because _getCurrentHub is invalid.`);return}if(!this._latestRouteName){(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.warn(`[Tracing] Did not create ${a} transaction because _latestRouteName is missing.`);return}const c=this._getCurrentHub(),{location:d}=u,l={name:this._latestRouteName,op:a,trimEnd:!0,metadata:{source:this._latestRouteSource||"url"}};e=de(c,l,i,s,!0,{location:d},o)};["click"].forEach(i=>{addEventListener(i,t,{once:!1,capture:!0})})}}function le(n){const e=Ue(`meta[name=${n}]`);return e?e.getAttribute("content"):null}function It(n){n._metadata=n._metadata||{},n._metadata.sdk=n._metadata.sdk||{name:"sentry.javascript.react",packages:[{name:"npm:@sentry/react",version:ae}],version:ae},ke(n)}function Bt(n){const e=n.match(/^([^.]+)/);return e!==null&&parseInt(e[0])>=17}const pe={componentStack:null,error:null,eventId:null};function Gt(n,e){const t=new WeakMap;function i(s,o){if(!t.has(s)){if(s.cause)return t.set(s,!0),i(s.cause,o);s.cause=o}}i(n,e)}class U extends F.exports.Component{__init(){this.state=pe}__init2(){this._openFallbackReportDialog=!0}constructor(e){super(e),U.prototype.__init.call(this),U.prototype.__init2.call(this),U.prototype.__init3.call(this);const t=b().getClient();t&&t.on&&e.showDialog&&(this._openFallbackReportDialog=!1,t.on("afterSendEvent",i=>{!i.type&&i.event_id===this._lastEventId&&re({...e.dialogOptions,eventId:this._lastEventId})}))}componentDidCatch(e,{componentStack:t}){const{beforeCapture:i,onError:s,showDialog:o,dialogOptions:a}=this.props;Ae(r=>{if(Bt(F.exports.version)&&Ce(e)){const d=new Error(e.message);d.name=`React ErrorBoundary ${d.name}`,d.stack=t,Gt(e,d)}i&&i(r,e,t);const c=we(e,{contexts:{react:{componentStack:t}}});s&&s(e,t,c),o&&(this._lastEventId=c,this._openFallbackReportDialog&&re({...a,eventId:c})),this.setState({error:e,componentStack:t,eventId:c})})}componentDidMount(){const{onMount:e}=this.props;e&&e()}componentWillUnmount(){const{error:e,componentStack:t,eventId:i}=this.state,{onUnmount:s}=this.props;s&&s(e,t,i)}__init3(){this.resetErrorBoundary=()=>{const{onReset:e}=this.props,{error:t,componentStack:i,eventId:s}=this.state;e&&e(t,i,s),this.setState(pe)}}render(){const{fallback:e,children:t}=this.props,i=this.state;if(i.error){let s;return typeof e=="function"?s=e({error:i.error,componentStack:i.componentStack,resetError:this.resetErrorBoundary,eventId:i.eventId}):s=e,F.exports.isValidElement(s)?s:(e&&(typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__)&&_.warn("fallback did not produce a valid ReactElement"),null)}return typeof t=="function"?t():t}}const j=({children:n,...e})=>R(He,{"data-testid":"error-fallback",...e,children:n}),fe={generic:R(j,{"data-testid":"error-fallback"}),SessionExpiredError:ne(j,{heading:"Your session has expired",children:["Please refresh your browser and try again. If this doesn't solve the problem, visit our ",R("a",{href:"https://openstax.secure.force.com/help",target:"_blank",children:"Support Center"}),"."]}),UnauthorizedError:ne(j,{heading:"Uh-oh, it seems you can't access this page.",children:["You may not have the required permissions or may have been logged out. Try refreshing the page or restarting your browser. If the issue persists, visit our ",R("a",{href:"https://openstax.secure.force.com/help",target:"_blank",children:"Support Center"}),"."]})},he=n=>{if(!n)return;const{TYPE:e,name:t}=n.constructor;return e&&typeof e=="string"?e:t},kt=({children:n,renderFallback:e,fallback:t=fe.generic,catchUnhandledRejections:i=!0,windowImpl:s=window,sentryDsn:o,sentryInit:a,...r})=>{const[c,d]=P.useState(null),l={...fe,...r.errorFallbacks},m=c!=null&&c.type?l[c.type]:void 0,E=c&&e?m||t:R(be,{children:n});return P.useEffect(()=>{!o&&!a||It(a||{dsn:o,environment:window.location.hostname,integrations:[new ee]})},[]),P.useEffect(()=>{if(!i)return;const f=y=>{var N;d({error:{name:y.type,message:(N=y.reason)==null?void 0:N.toString()},type:he(y.reason)})};return s.addEventListener("unhandledrejection",f),()=>s.removeEventListener("unhandledrejection",f)},[]),R(Oe.Provider,{value:c,children:R(U,{fallback:E,onError:(f,y,N)=>{d({error:f,type:he(f),componentStack:y,eventId:N})},...r,onReset:()=>d(null),children:E})})};export{kt as E};
